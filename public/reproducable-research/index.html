
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Reproducable research - Tom Torsney-Weir</title>
  <meta name="author" content="Tom Torsney-Weir">

  
  <meta name="description" content="I have a terrible memory for what I&#8217;ve done in the past. I can barely
remember what I had for breakfast let alone specifics about a data &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://www.tomtorsneyweir.com/reproducable-research">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Tom Torsney-Weir" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Tom Torsney-Weir</a></h1>
  
    <h2>MSc Visualization</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:www.tomtorsneyweir.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Home</a></li>
  <li><a href="/projects">Projects</a></li>
  <li><a href="/cv.html">CV</a></li>
  <li><a href="/blog">Blog</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Reproducable Research</h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-05-19T20:19:00-07:00" pubdate data-updated="true">May 19<span>th</span>, 2012</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>I have a terrible memory for what I&#8217;ve done in the past. I can barely
remember what I had for breakfast let alone specifics about a data analysis I
did from the past week. I tend to go down so many wrong paths that by the
time my weekly supervisor meeting rolls around I have no idea what I&#8217;ve done
or why I&#8217;ve done it. I would often stare dumbfounded when asked seemingly
simple questions like, &#8220;how did you make this graph?&#8221; or even
&#8220;why did you make this graph?&#8221;</p>

<p>So, for the past few months I&#8217;ve started producing weekly reports using R and
multimarkdown to give to my supervisors before our meetings. It&#8217;s a summary
of my work from the past week. This basically constitutes a lab notebook for
me. A lot of my work involves writing a lot of math formulae, producing plots
and images, some code to munge data, and text to explain what I&#8217;m doing.</p>

<!--more-->

<figure>
<img src="/images/notebook-preview.png" alt="" id="preview" title="preview image" style="width:640px;" class="block" /></figure>



<p>I use R for any sort of numerical computing and multimarkdown has been my
go-to markup language for some time. My favorite feature of multimarkdown is
its support for processing LaTeX math. Now that the
<a href="http://yihui.name/knitr/">knitr package</a> is out I
can tie my analysis code (written in R) to my explanations (written in
markdown). What&#8217;s also great about this system is that my analysis is
contained entirely in a text file that I can store in source control along
with any data and the rest of my project. </p>

<p>The rest of this post goes into detail about how I&#8217;ve set up Vim, knitr, and
<a href="http://markedapp.com/">Marked.app</a> on my Mac to automatically update my
report every time I save. The code is located at
<a href="https://bitbucket.org/gabysbrain/r-notebook">https://bitbucket.org/gabysbrain/r-notebook</a>.</p>

<h2 id="editor:vim">Editor: Vim</h2>

<p>The best thing about this method is that it&#8217;s pretty much editor agnostic.
Marked doesn&#8217;t care what editor you use as long as it&#8217;s editing markdown.
So, I get to use the only text editor I&#8217;ve ever liked: vim!</p>

<p>I linked Marked to vim with the instructions from
<a href="http://captainbollocks.tumblr.com/post/9858989188/linking-macvim-and-marked-app">A Whole lot of Bollocks&#8217; blog post</a>
so that I can hit <code>&lt;leader&gt;-m</code> and have the file I&#8217;m editing open in Marked.
Once the file is open it automatically updates every time I save.</p>

<p>To make my editing more efficient I use the
<a href="http://www.vim.org/scripts/script.php?script_id=2540">SnipMate plugin</a>
which brings TextMate-style snippets to vim. Basically, you can type a shorter
string, hit tab, and have it expand into anything you want. It&#8217;s really great
for adding boilerplate code. I particularly like this for adding the knitr
code blocks. With the fork of SnipMate I have set up
(<a href="https://github.com/gabysbrain/snipmate.vim">https://github.com/gabysbrain/snipmate.vim</a>) typing <code>rcode</code> expands to</p>

<pre><code>&lt;!--begin.rcode ${1},cache=TRUE,dependson='${2}'
${3}
end.rcode--&gt;
</code></pre>

<p>and typing <code>rfig</code> expands to</p>

<pre><code>&lt;!--begin.rcode ${1},cache=TRUE,dependson='${2}',fig.width=${3:12},fig.height=${4:12},dev='png'
${5}
end.rcode--&gt;
</code></pre>

<p>I&#8217;m also using the multimarkdown syntax highlighter:
<a href="https://github.com/jngeist/vim-multimarkdown">https://github.com/jngeist/vim-multimarkdown</a>.</p>

<h2 id="processor:knitr">Processor: knitr</h2>

<p>In its default incarnation knitr provides a lot of functionality out of the
box for processing R code embedded in a markdown document. The killer feature
(other than the markdown output) in my opinion is its caching and and
dependency layer so I don&#8217;t have to wait for R to recompute every section when
I just change one. It&#8217;s also smart enough to recompute any blocks that depend
on the one I changed. </p>

<p>The main issue is that knitr is designed to be run from the desired working
directory. This is how it sets the locations for the images and cache files.
Luckily, when you run a custom markdown processor in recent versions of Marked
it appends the directory containing whatever file you&#8217;re editing to the end of
the path. So, all you have to do before running code through knitr is change
the current working directory to the last item in PATH and the cache and
images will be in the proper place. </p>

<p>This script also allows me to add some custom hooks into the markdown
processor. I mostly use this to test out new features before submitting them
to the main knitr development. </p>

<h2 id="viewer:marked">Viewer: Marked</h2>

<p>This all gets piped through Marked. Marked.app is an amazing and simple
markdown preview tool. When the preview is open it watches my source file for
changes and automatically updates when I save in vim. </p>

<p>By default it uses its own multimarkdown processor but you can override that
with your own. It also supports a custom css file. The one I&#8217;m using is
slightly modified from the github theme but with nicer tables. </p>

<h2 id="future">Future</h2>

<p>Right now I print the final document to PDF and then email the file to my
supervisors. Eventually though I&#8217;m going to upload the whole thing to a
private research blog that we all share.</p>

<p>I&#8217;d also like to add a lot more interactive features to the HTML. The killer
features would be interactive manipulation of graphics and having those
changes reflected in the source document. It would also be great if I could
inspect R objects directly in the HTML document as well. This would
require some interaction with a running version of R though.</p>

<p>But for now, I&#8217;m happy that I can easily make a record of what I&#8217;ve done
each week and my supervisor is happy that I can show what I&#8217;ve done!</p></div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Tom Torsney-Weir</span></span>

      








  


<time datetime="2012-05-19T20:19:00-07:00" pubdate data-updated="true">May 19<span>th</span>, 2012</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/research/'>research</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://www.tomtorsneyweir.com/reproducable-research/" data-via="gabysbrain" data-counturl="http://www.tomtorsneyweir.com/reproducable-research/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
      
        <a class="basic-alignment right" href="/r-notebook/" title="Next Post: R notebook">R notebook &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      
    
      
    
      
        <li class="post">
          <a href="/reproducable-research/">Reproducable research</a>
        </li>
      
    
  </ul>
</section>


<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating...</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("gabysbrain", 4, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/gabysbrain" class="twitter-follow-button" data-show-count="false">Follow @gabysbrain</a>
  
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2012 - Tom Torsney-Weir -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
