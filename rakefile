
task :download_bib do
  sh('curl', '-L', '-o', 'all.bib', 'https://www.dropbox.com/s/th9r55x8z8yemff/all.bib?dl=0')
end

# setup build environment
task :setup do
  setup
end

# setup build environment for codeship
task :cssetup do
  sh('rvm', 'use', '$(cat', '.ruby-version)', '--install')
  setup
end

task :build => [:download_bib] do
  sh('bundle', 'exec', 'middleman', 'build')
end

task :clean do
  sh('rm', '-rf', 'build')
end

task :deploy => [:clean, :build] do
  sh('bundle', 'exec', 'middleman', 'deploy')
end

# install dependencies, etc
def setup
  sh('bundle', 'install')
  sh('npm', 'install', 'bower')
  sh('bower', 'install')
end

